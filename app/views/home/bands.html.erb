

<nav class="nav-fillpath">
	<a class="prev left-control">
		<span class="icon-wrap"></span>
		<h3 style="width:100px"><strong>BAND </strong><span class="bandNumPrev"><%= Draft.first.liveBand.to_i  - 1 %></span></h3>
	</a>
	<a class="next right-control">
		<span class="icon-wrap"></span>
		<h3 style="width:100px"><strong>BAND </strong><span class="bandNumNext"><%= Draft.first.liveBand.to_i  + 1 %></span> </h3>
	</a>
</nav>


<div id="bands">
<% Band.all.each do |band| %>

<% @player1 = Player.where(number: band.player1.to_i).first %>
<% @player2 = Player.where(number: band.player2.to_i).first %>
<% @player3 = Player.where(number: band.player3.to_i).first %>
<% @player4 = Player.where(number: band.player4.to_i).first %>

	<div class="band-<%=band.number %>">

		<div class="band-number">BAND <%= band.number %> </div>

			<% if !@player1.nil? %>
			<div class="row">
				<div class="small-12 columns">
					<div class="player">
						<div class="number">
							<div class="number-inner"><%= image_tag(@player1.image.url) %> </div>
						</div>
						<div class="player-name">
							<div class="player-name-inner"><%= @player1.name %></div>
						</div>
					</div>
				</div>
			</div>
			<% end %>

			<% if !@player2.nil? %>
			<div class="row">
				<div class="small-12 columns">
					<div class="player">
						<div class="number">
							<div class="number-inner"><%= image_tag(@player2.image.url) %> </div>
						</div>
						<div class="player-name">
							<div class="player-name-inner"><%= @player2.name %></div>
						</div>
					</div>
				</div>
			</div>
			<% end %>

			<% if !@player3.nil? %>
			<div class="row">
				<div class="small-12 columns">
					<div class="player">
						<div class="number">
							<div class="number-inner"><%= image_tag(@player3.image.url) %> </div>
						</div>
						<div class="player-name">
							<div class="player-name-inner"><%= @player3.name %></div>
						</div>
					</div>
				</div>
			</div>
			<% end %>

			<% if !@player4.nil? %>
			<div class="row">
				<div class="small-12 columns">
					<div class="player">
						<div class="number">
							<div class="number-inner"><%= image_tag(@player4.image.url) %> </div>
						</div>
						<div class="player-name">
							<div class="player-name-inner"><%= @player4.name %></div>
						</div>
					</div>
				</div>
			</div>
			<% end %>

	</div>
<% end %>

</div>

<script>
$( document ).ready(function() {
		
		//var liveband;
		var staticLb = <%= Draft.first.liveBand.to_i %>
		var lb = <%= Draft.first.liveBand.to_i %>
		var totalBands = <%= Draft.first.numberOfBands %>
		setCurrentBand(lb);


		function setCurrentBand(band){
			lb = band
			if (lb == 1) {
				pb = totalBands;
				nb = 2;

			}
			else if (lb == totalBands){
				nb = 1;
				pb = totalBands-1;
			}
			else{
				pb = lb - 1;
				nb = lb + 1;
			}
			$('.bandNumPrev').text(''+pb);
			$('.bandNumNext').text(''+nb);
		}


		$(".band-" + lb).siblings().hide();
		$(".left-control").click(function(){
			$(".band-" + pb).siblings().hide();
			$(".band-" + pb).show();
			setCurrentBand(pb);
		});
		$(".right-control").click(function(){
			$(".band-" + nb).siblings().hide();
			$(".band-" + nb).show();
			setCurrentBand(nb);
		});


	showLiveBand = function(liveband) {
	  		if (liveband != staticLb){
	  			window.location.href = "updatedBand";
			}
	 };

	gon.watch('liveband', {
	  interval: 4000
	}, showLiveBand);

	


});
</script>
